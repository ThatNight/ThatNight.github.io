<!DOCTYPE html>




<html class="theme-next gemini" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="ContentProvider," />










<meta name="description" content="ContentProvider 内容提供器 什么是内容提供器官方解释:  A content provider manages access to a central repository of data. A provider is part of an Android application, which often provides its own UI for working with t">
<meta name="keywords" content="ContentProvider">
<meta property="og:type" content="article">
<meta property="og:title" content="ContentProvider 内容提供器">
<meta property="og:url" content="https://charlie-captain.github.io/2017/12/31/[四大组件] ContentProvider 内容提供器/index.html">
<meta property="og:site_name" content="Charlie-Captain">
<meta property="og:description" content="ContentProvider 内容提供器 什么是内容提供器官方解释:  A content provider manages access to a central repository of data. A provider is part of an Android application, which often provides its own UI for working with t">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-01-06T13:11:33.308Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ContentProvider 内容提供器">
<meta name="twitter:description" content="ContentProvider 内容提供器 什么是内容提供器官方解释:  A content provider manages access to a central repository of data. A provider is part of an Android application, which often provides its own UI for working with t">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://charlie-captain.github.io/2017/12/31/[四大组件] ContentProvider 内容提供器/"/>





  <title>ContentProvider 内容提供器 | Charlie-Captain</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?74f1a8bbc0e841e49924177b36e02d9a";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Charlie-Captain</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Charlie</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://charlie-captain.github.io/2017/12/31/[四大组件] ContentProvider 内容提供器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Charlie">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/18600419?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charlie-Captain">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">ContentProvider 内容提供器</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-31T20:19:17+08:00">
                2017-12-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/四大组件/" itemprop="url" rel="index">
                    <span itemprop="name">四大组件</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/12/31/[四大组件] ContentProvider 内容提供器/" class="leancloud_visitors" data-flag-title="ContentProvider 内容提供器">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="ContentProvider-内容提供器"><a href="#ContentProvider-内容提供器" class="headerlink" title="ContentProvider 内容提供器"></a>ContentProvider 内容提供器</h1><ul>
<li><h2 id="什么是内容提供器"><a href="#什么是内容提供器" class="headerlink" title="什么是内容提供器"></a>什么是内容提供器</h2><h3 id="官方解释"><a href="#官方解释" class="headerlink" title="官方解释:"></a>官方解释:</h3><p>  A content provider manages access to a central repository of data. A provider is part of an Android application, which often provides its own UI for working with the data. However, content providers are primarily intended to be used by other applications, which access the provider using a provider client object. Together, providers and provider clients offer a consistent, standard interface to data that also handles inter-process communication and secure data access.</p>
<h3 id="通俗易懂"><a href="#通俗易懂" class="headerlink" title="通俗易懂:"></a>通俗易懂:</h3><p>  主要是<strong>用于不同的应用程序之间实现数据共享的功能.</strong></p>
<p>  内容提供器以<strong>一个或多个表</strong>(跟数据库的表类似)的形式呈献给外部应用.</p>
<p>  分两类:</p>
<ul>
<li>使用现有的内容提供器来读取和操作应用程序的数据</li>
<li><p>创建自己的内容提供器提供外部访问接口</p>
<a id="more"></a>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><h2 id="ContentProvider的基本用法"><a href="#ContentProvider的基本用法" class="headerlink" title="ContentProvider的基本用法"></a>ContentProvider的基本用法</h2><ul>
<li><h3 id="访问其他程序的数据"><a href="#访问其他程序的数据" class="headerlink" title="访问其他程序的数据"></a>访问其他程序的数据</h3><ul>
<li><h4 id="ContentResolver类"><a href="#ContentResolver类" class="headerlink" title="ContentResolver类"></a>ContentResolver类</h4><p>  如果想要访问内容提供器中共享的数据, 就需要借助ContentResolver类, 可以通过Context.getContentResolver()方法来获取该类的实例.</p>
<p>  这个<strong>ContentResolver</strong>提供了一些对数据进行CRUD的操作, 也就是常说的”增删查改”</p>
<p>  <strong>但是</strong>, 与SQLiteDatabase不同的是, ContentResolver的增删查改方法是不接受表名参数的,而是  <strong>Uri</strong>,</p>
<p>  <strong>Uri</strong>: 由 权限 和 路径 组成的. (用于在提供程序中标识数据的URI)。</p>
<p>  Uri的标准写法如下：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">content://com.example.app.provider/table1</span><br></pre></td></tr></table></figure>
<p>  table1为数据库的名字;</p>
<p>  再使用Uri.parse(uri) 就可以将字符串转发为Uri类型啦.</p>
<p>  <strong>说了那么多,我们还没开始访问数据</strong>, 代码如下:</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Cursor cursor=getContentResolver().query(</span><br><span class="line">    uri,</span><br><span class="line">    projection,</span><br><span class="line">    selection,</span><br><span class="line">    selectionArgs,</span><br><span class="line">    sortOrder</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>  上面传入参数很多, 下面表格将这些参数和SQLiteDatabase中的query()进行了对比:</p>
<p>  | query()       | 对应SQL部分                   | 描述                |<br>  | ————- | ————————- | —————– |<br>  | uri           | from table_name           | 指定查询应用程序的某一个表     |<br>  | projection    | select column1,column2    | 指定查询的列名           |<br>  | selection     | where column=value        | 为where中的占位符提供具体的值 |<br>  | selectionArgs | -                         | 为where的占位符提供具体的值  |<br>  | sortOrder     | order by column1, column2 | 指定查询结果的排序方式       |</p>
<p>  很明显上面返回的是Cursor类, 读取数据的思路就是通过<strong>移动游标的位置</strong>来遍历Cursor的所有行, 然后取出每一行相应列的数据, 代码如下:</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if(cursor!=null)&#123;</span><br><span class="line">    while(cursor.moveToNext())&#123;</span><br><span class="line">        String column1 = cursor.getString(cursor.getColumnIndex(&quot;column1&quot;));</span><br><span class="line">        int column2 = cursor.getInt(cursor.getColumnIndex(&quot;column2&quot;));</span><br><span class="line">    &#125;</span><br><span class="line">    cursor.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  以下是各种操作的简单介绍:</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ContentValues values=new ContentValues();</span><br><span class="line"></span><br><span class="line">//插入数据</span><br><span class="line">getContentResolver().insert(uri, values);</span><br><span class="line"></span><br><span class="line">//更新数据</span><br><span class="line">getContentResolver().update(uri, values, &quot;column1 = ? and column2 = ?&quot;, new String[]&#123;&quot;text&quot;,&quot;1&quot;&#125;);</span><br><span class="line"></span><br><span class="line">//删除数据</span><br><span class="line">getContentResolver().delete(uri, &quot;column2 = ?&quot;, new String[]&#123;&quot;1&quot;&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><h2 id="创建自己的ContentProvider"><a href="#创建自己的ContentProvider" class="headerlink" title="创建自己的ContentProvider"></a>创建自己的ContentProvider</h2><ul>
<li><h3 id="创建前的准备"><a href="#创建前的准备" class="headerlink" title="创建前的准备"></a>创建前的准备</h3><ol>
<li><h4 id="决定你是否需要ContentProvider"><a href="#决定你是否需要ContentProvider" class="headerlink" title="决定你是否需要ContentProvider"></a>决定你是否需要ContentProvider</h4><ul>
<li><p>你想为其他应用提供<strong>复杂</strong>的数据或文件</p>
</li>
<li><p>你想允许用户将复杂的数据从你的应用<strong>复制</strong>到其他应用中</p>
</li>
<li><p>你想使用<strong>搜索框架</strong>提供自定义搜索建议</p>
</li>
</ul>
</li>
<li><h4 id="创建步骤"><a href="#创建步骤" class="headerlink" title="创建步骤"></a>创建步骤</h4><ul>
<li><p>设计原始存储, <strong>文件数据</strong>(照片\音频…)或者<strong>结构化数据</strong>(数据库或数组…)</p>
</li>
<li><p>继承ContentProvider类, 并实现具体方法</p>
</li>
<li><p>定义提供程序的<strong>授权字符串</strong>\<strong>URI</strong>\<strong>列名称</strong></p>
</li>
<li><p>添加其他可选的部分</p>
</li>
</ul>
</li>
</ol>
</li>
<li><h3 id="实例操作"><a href="#实例操作" class="headerlink" title="实例操作"></a>实例操作</h3><ul>
<li><h4 id="创建数据库-这里不详细介绍了"><a href="#创建数据库-这里不详细介绍了" class="headerlink" title="创建数据库, 这里不详细介绍了."></a>创建数据库, 这里不详细介绍了.</h4></li>
<li><h4 id="继承ContentProvider类"><a href="#继承ContentProvider类" class="headerlink" title="继承ContentProvider类"></a>继承ContentProvider类</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public class DemoContentProvider extends ContentProvider &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onCreate() &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Nullable</span><br><span class="line">    @Override</span><br><span class="line">    public Cursor query(@NonNull Uri uri, @Nullable String[] projection, @Nullable String selection, @Nullable String[] selectionArgs, @Nullable String sortOrder) &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Nullable</span><br><span class="line">    @Override</span><br><span class="line">    public String getType(@NonNull Uri uri) &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Nullable</span><br><span class="line">    @Override</span><br><span class="line">    public Uri insert(@NonNull Uri uri, @Nullable ContentValues values) &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int delete(@NonNull Uri uri, @Nullable String selection, @Nullable String[] selectionArgs) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int update(@NonNull Uri uri, @Nullable ContentValues values, @Nullable String selection, @Nullable String[] selectionArgs) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><h4 id="设计内容URI"><a href="#设计内容URI" class="headerlink" title="设计内容URI"></a>设计内容URI</h4><ul>
<li><h5 id="设计授权"><a href="#设计授权" class="headerlink" title="设计授权"></a>设计授权</h5><p>  如果Android包名为com.example.<appname>, 则为提供程序提供com.example.<appname>.provider 授权</appname></appname></p>
</li>
<li><h5 id="设计路径结构"><a href="#设计路径结构" class="headerlink" title="设计路径结构"></a>设计路径结构</h5><p>  合并上一段的权限来生成内容URI : com.example.<appname>.provider/table1 或者table2 </appname></p>
</li>
<li><h5 id="处理内容URI-ID"><a href="#处理内容URI-ID" class="headerlink" title="处理内容URI ID"></a>处理内容URI ID</h5><p>  末尾有_ID值就是来对表的单个行的访问.</p>
</li>
<li><h5 id="URI模式"><a href="#URI模式" class="headerlink" title="URI模式"></a>URI模式</h5><p>  由于有实用类UriMatcher, 所以可以使用以下通配符来匹配内容:</p>
<ul>
<li><p>“ <em> “ : 匹配任意长度的<em>*任意字符</em></em></p>
</li>
<li><p>“ # “ : 匹配任意长度的<strong>数字</strong></p>
<p>标准的URI:<br>content://com.example.app.provider/….</p>
</li>
</ul>
</li>
</ul>
</li>
<li><h4 id="综合代码如下"><a href="#综合代码如下" class="headerlink" title="综合代码如下:"></a>综合代码如下:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">public class DemoContentProvider extends ContentProvider &#123;</span><br><span class="line">    private static final int TABLE1_DIR = 0;</span><br><span class="line">    private static final int TABLE1_ITEM = 1;</span><br><span class="line"></span><br><span class="line">    private static final UriMatcher sUriMatcher = new UriMatcher(UriMatcher.NO_MATCH);</span><br><span class="line"></span><br><span class="line">    static &#123;</span><br><span class="line">        sUriMatcher.addURI(&quot;com.example.app.provider&quot;, &quot;table1&quot;, TABLE1_DIR);</span><br><span class="line">        sUriMatcher.addURI(&quot;com.example.app.provider&quot;, &quot;table1/#&quot;, TABLE1_ITEM);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onCreate() &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Nullable</span><br><span class="line">    @Override</span><br><span class="line">    public Cursor query(@NonNull Uri uri, @Nullable String[] projection, @Nullable String selection, @Nullable String[] selectionArgs, @Nullable String sortOrder) &#123;</span><br><span class="line">        SQLiteDatabase db = dbHelper.getReadableDatabase();</span><br><span class="line">        Cursor cursor = null;</span><br><span class="line">        switch (sUriMatcher.match(uri)) &#123;</span><br><span class="line">            case TABLE1_DIR:</span><br><span class="line">                //查询table1表中的所有数据</span><br><span class="line">                break;</span><br><span class="line">            case TABLE1_ITEM:</span><br><span class="line">                //查询table1表中的单条数据</span><br><span class="line">                break;</span><br><span class="line">            default:</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">        return cursor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Nullable</span><br><span class="line">    @Override</span><br><span class="line">    public String getType(@NonNull Uri uri) &#123;</span><br><span class="line">        switch (sUriMatcher.match(uri)) &#123;</span><br><span class="line">            case TABLE1_DIR:</span><br><span class="line">                return &quot;vnd.android.cursor.dir/vnd.com.example.app.provider.table1&quot;;</span><br><span class="line">            case TABLE1_ITEM:</span><br><span class="line">                return &quot;vnd.android.cursor.item/vnd.com.example.app.provider.table1&quot;;</span><br><span class="line">            default:</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Nullable</span><br><span class="line">    @Override</span><br><span class="line">    public Uri insert(@NonNull Uri uri, @Nullable ContentValues values) &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int delete(@NonNull Uri uri, @Nullable String selection, @Nullable String[] selectionArgs) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int update(@NonNull Uri uri, @Nullable ContentValues values, @Nullable String selection, @Nullable String[] selectionArgs) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不知道大家有没有看到getType这个方法,返回了一些莫名其妙的字符串</p>
<p>其实这些都是MIME类型的数据</p>
<p>格式如下:</p>
</li>
<li><p>必须vnd开头</p>
</li>
<li>路径结尾的话就后接android.cursor.dir/ , 若是id结尾就接android.cursor.item/</li>
<li>最后接上 vnd.<authority>.<path></path></authority></li>
</ul>
</li>
</ul>
</li>
<li><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h4 id="这个内容提供器有很多demo-需要结合数据库来讲-我想等讲完数据库再上传这个DEMO吧-谢谢大家看我的学习笔记"><a href="#这个内容提供器有很多demo-需要结合数据库来讲-我想等讲完数据库再上传这个DEMO吧-谢谢大家看我的学习笔记" class="headerlink" title="这个内容提供器有很多demo , 需要结合数据库来讲, 我想等讲完数据库再上传这个DEMO吧.谢谢大家看我的学习笔记!"></a>这个内容提供器有很多demo , 需要结合数据库来讲, 我想等讲完数据库再上传这个DEMO吧.谢谢大家看我的学习笔记!</h4><p>  ​    </p>
</li>
</ul>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>感谢阅读,您的支持将鼓励我继续创作！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="Charlie 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="Charlie 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ContentProvider/" rel="tag"># ContentProvider</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/12/31/Android IPC机制-AIDL详解/" rel="next" title="什么是AIDL">
                <i class="fa fa-chevron-left"></i> 什么是AIDL
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/31/[Android] Retrofit+Rxjava+MVP三大框架集成男人帮APP/" rel="prev" title="Retrofit+Rxjava+MVP三大框架集成男人帮APP">
                Retrofit+Rxjava+MVP三大框架集成男人帮APP <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
<span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_fav">收藏夹</a>
<a class="jiathis_button_copy">复制网址</a>
<a class="jiathis_button_email">邮件</a>
<a class="jiathis_button_weixin">微信</a>
<a class="jiathis_button_qzone">QQ空间</a>
<a class="jiathis_button_tqq">腾讯微博</a>
<a class="jiathis_button_douban">豆瓣</a>
<a class="jiathis_button_share">一键分享</a>

<a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
var jiathis_config={
  data_track_clickback:true,
  summary:"",
  shortUrl:false,
  hideMore:false
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script>
<!-- JiaThis Button END -->
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMzAwMy85NTY1"></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://avatars0.githubusercontent.com/u/18600419?s=460&v=4"
                alt="Charlie" />
            
              <p class="site-author-name" itemprop="name">Charlie</p>
              <p class="site-description motion-element" itemprop="description">go on.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">24</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/thatnight" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/Williamschew/activities" target="_blank" title="知乎">
                      
                        <i class="fa fa-fw fa-globe"></i>知乎</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ContentProvider-内容提供器"><span class="nav-number">1.</span> <span class="nav-text">ContentProvider 内容提供器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是内容提供器"><span class="nav-number">1.1.</span> <span class="nav-text">什么是内容提供器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#官方解释"><span class="nav-number">1.1.1.</span> <span class="nav-text">官方解释:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通俗易懂"><span class="nav-number">1.1.2.</span> <span class="nav-text">通俗易懂:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ContentProvider的基本用法"><span class="nav-number">1.2.</span> <span class="nav-text">ContentProvider的基本用法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#访问其他程序的数据"><span class="nav-number">1.2.1.</span> <span class="nav-text">访问其他程序的数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ContentResolver类"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">ContentResolver类</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建自己的ContentProvider"><span class="nav-number">1.3.</span> <span class="nav-text">创建自己的ContentProvider</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建前的准备"><span class="nav-number">1.3.1.</span> <span class="nav-text">创建前的准备</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#决定你是否需要ContentProvider"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">决定你是否需要ContentProvider</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#创建步骤"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">创建步骤</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实例操作"><span class="nav-number">1.3.2.</span> <span class="nav-text">实例操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建数据库-这里不详细介绍了"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">创建数据库, 这里不详细介绍了.</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#继承ContentProvider类"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">继承ContentProvider类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#设计内容URI"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">设计内容URI</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#设计授权"><span class="nav-number">1.3.2.3.1.</span> <span class="nav-text">设计授权</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#设计路径结构"><span class="nav-number">1.3.2.3.2.</span> <span class="nav-text">设计路径结构</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#处理内容URI-ID"><span class="nav-number">1.3.2.3.3.</span> <span class="nav-text">处理内容URI ID</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#URI模式"><span class="nav-number">1.3.2.3.4.</span> <span class="nav-text">URI模式</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#综合代码如下"><span class="nav-number">1.3.2.4.</span> <span class="nav-text">综合代码如下:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">1.4.</span> <span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#这个内容提供器有很多demo-需要结合数据库来讲-我想等讲完数据库再上传这个DEMO吧-谢谢大家看我的学习笔记"><span class="nav-number">1.4.0.1.</span> <span class="nav-text">这个内容提供器有很多demo , 需要结合数据库来讲, 我想等讲完数据库再上传这个DEMO吧.谢谢大家看我的学习笔记!</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; 2016 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Charlie</span>

  
</div>
<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>
<!-- 
  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>

-->



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("rNGy7xuMe8xVYBpzyk6gRnfd-gzGzoHsz", "RscD6Blam0yUUGbO55M3F0Q5");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
